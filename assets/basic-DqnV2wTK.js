import{j as e,r as u,R as U,a as J}from"./client-DvaAtPIX.js";const v=({children:t,variant:s="primary",size:a="md",fullWidth:r=!1,className:x="",...c})=>{const o="rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 inline-flex items-center justify-center",g={primary:"bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-900",secondary:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-600",ghost:"text-gray-600 hover:bg-gray-100 focus:ring-gray-200"},m={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-5 py-2.5 text-lg"},h=r?"w-full":"";return e.jsx("button",{className:`${o} ${g[s]} ${m[a]} ${h} ${x}`,...c,children:t})},E=({children:t,variant:s="primary",size:a="md",className:r=""})=>{const x="text-white rounded inline-flex items-center justify-center",c=a==="sm"?"text-xs px-2 py-0.5":"text-sm px-2.5 py-1",o={primary:"bg-gray-900",success:"bg-green-500",warning:"bg-orange-500",danger:"bg-red-500",info:"bg-blue-500"};return e.jsx("span",{className:`${x} ${c} ${o[s]} ${r}`,children:t})},Y=t=>`${t.toLocaleString()}원`,V=t=>`₩${t.toLocaleString()}`,Z=t=>{const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${r}`},P=t=>`${(t*100).toFixed(0)}%`,G=t=>`-${t.toLocaleString()}원`,K=({product:t,remainingStock:s,onAddToCart:a})=>{const r=t.discounts.length>0?Math.max(...t.discounts.map(x=>x.rate)):0;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-24 h-24 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1"})})}),t.isRecommended&&e.jsx("span",{className:"absolute top-2 right-2",children:e.jsx(E,{variant:"danger",size:"sm",children:"BEST"})}),r>0&&e.jsx("span",{className:"absolute top-2 left-2",children:e.jsxs(E,{variant:"warning",size:"sm",children:["~",P(r)]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:t.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:s<=0?"SOLD OUT":V(t.price)}),t.discounts.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[t.discounts[0].quantity,"개 이상 구매시 할인 ",P(t.discounts[0].rate)]})]}),e.jsx("div",{className:"mb-3",children:s<=5&&s>0?e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",s,"개 남음"]}):s>5?e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",s,"개"]}):null}),e.jsx(v,{onClick:()=>a(t),disabled:s<=0,variant:"primary",fullWidth:!0,children:s<=0?"품절":"장바구니 담기"})]})]})},q=({size:t=24,...s}={})=>({width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",...s}),$=t=>e.jsxs("svg",{...q(t),children:[e.jsx("path",{d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5"}),e.jsx("path",{d:"M7 13l-2.293 2.293A1 1 0 0 0 5.414 16H17"}),e.jsx("circle",{cx:"17",cy:"18",r:"2"}),e.jsx("circle",{cx:"9",cy:"18",r:"2"})]}),M=t=>e.jsx("svg",{...q(t),children:e.jsx("path",{d:"M12 5v14M5 12h14"})}),D=t=>e.jsx("svg",{...q(t),children:e.jsx("path",{d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),X=({item:t,discount:s,onUpdateQuantity:a,onRemove:r})=>{const x=t.product.price*t.quantity,c=Math.round(x*(1-s)),o=s>0,g=o?Math.round((1-c/x)*100):0;return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:t.product.name}),e.jsx("button",{onClick:()=>r(t.product.id),className:"text-gray-400 hover:text-red-500 ml-2","aria-label":"상품 삭제",children:e.jsx(D,{className:"w-4 h-4","aria-hidden":!0})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>a(t.product.id,t.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100","aria-label":"수량 감소",children:"−"}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:t.quantity}),e.jsx("button",{onClick:()=>a(t.product.id,t.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100","aria-label":"수량 증가",children:"+"})]}),e.jsxs("div",{className:"text-right",children:[o&&e.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",P(g/100)]}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:V(c)})]})]})]})},ee=({cart:t,totals:s,coupons:a,selectedCouponCode:r,onUpdateQuantity:x,onRemoveFromCart:c,onSelectCoupon:o,onCompleteOrder:g,getMaxApplicableDiscount:m})=>e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx($,{className:"w-5 h-5 mr-2","aria-hidden":!0}),"장바구니"]}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx($,{className:"text-gray-300 mx-auto mb-4",size:64,"aria-hidden":!0}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):e.jsx("div",{className:"space-y-3",children:t.map(h=>e.jsx(X,{item:h,discount:m(h),onUpdateQuantity:x,onRemove:c},h.product.id))})]}),t.length>0&&e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"소계"}),e.jsx("span",{className:"font-medium",children:V(s.subtotal)})]}),s.discountAmount>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"할인 금액"}),e.jsx("span",{children:G(s.discountAmount)})]}),e.jsxs("div",{className:"flex justify-between text-base font-bold pt-2 border-t",children:[e.jsx("span",{children:"합계"}),e.jsx("span",{className:"text-blue-600",children:V(s.total)})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"coupon-select",className:"block text-sm font-medium text-gray-700 mb-2",children:"쿠폰 적용"}),e.jsxs("select",{id:"coupon-select",onChange:h=>o(h.target.value),value:r||"",disabled:t.length===0,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),a.map(h=>e.jsxs("option",{value:h.code,children:[h.name," (",h.discountType==="amount"?`${h.discountValue.toLocaleString()}원`:`${h.discountValue}%`,")"]},h.code))]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(v,{onClick:g,variant:"primary",fullWidth:!0,children:[V(s.total),"원 결제하기"]})})]})]}),L=(t,s)=>{const a=s.some(x=>x.quantity>=10),r=t.product.discounts.reduce((x,c)=>t.quantity>=c.quantity&&c.rate>x?c.rate:x,0);return a?Math.min(r+.05,.5):r},te=(t,s)=>{const a=L(t,s);return Math.round(t.product.price*t.quantity*(1-a))},O=(t,s)=>{const a=t.reduce((c,o)=>c+te(o,t),0);let r=0;s&&(s.discountType==="percentage"?a>=1e4&&(r=Math.round(a*(s.discountValue/100))):r=s.discountValue);const x=Math.max(0,a-r);return{subtotal:a,discountAmount:r,total:x}};function se({items:t,searchTerm:s,searchFields:a=["name","description"]}){return{filteredItems:u.useMemo(()=>{if(!s||s.trim()==="")return t;const x=s.toLowerCase();return t.filter(c=>a.some(o=>{const g=c[o];return typeof g=="string"?g.toLowerCase().includes(x):!1}))},[t,s,a])}}function re({selectedCoupon:t,coupons:s,cart:a,onCouponInvalid:r,onMinimumAmountWarning:x}){u.useEffect(()=>{t&&!s.some(o=>o.code===t.code)&&r?.()},[s,t,r]),u.useEffect(()=>{a.length===0&&t&&r?.()},[a.length,t,r]);const c=o=>{if(!o)return{isValid:!0};if(a.length===0)return{isValid:!1,errorMessage:"장바구니에 상품을 추가해주세요"};if(o.discountType==="percentage"){const{subtotal:g}=O(a,null);if(g<1e4)return{isValid:!1,warningMessage:"10,000원 이상 구매시 쿠폰을 사용할 수 있습니다!"}}return{isValid:!0}};return u.useEffect(()=>{if(t){const o=c(t);o.warningMessage&&x&&x(o.warningMessage)}},[t,a]),{validateCouponApplicability:c}}function ae({coupons:t,cart:s,onCompleteOrder:a}){const[r,x]=u.useState(null),c=u.useCallback(m=>{const h=t.find(i=>i.code===m)||null;x(h)},[t]),o=u.useCallback(()=>{a(),x(null)},[a]),g=u.useMemo(()=>O(s,r),[s,r]);return{selectedCoupon:r,totals:g,handleCouponChange:c,handleCompleteOrder:o}}const ne=({products:t,cart:s,debouncedSearchTerm:a,getRemainingStock:r,addToCart:x,removeFromCart:c,updateQuantity:o,completeOrder:g,coupons:m,addNotification:h})=>{const{selectedCoupon:i,totals:l,handleCouponChange:d,handleCompleteOrder:n}=ae({coupons:m,cart:s,onCompleteOrder:g}),{filteredItems:p}=se({items:t,searchTerm:a,searchFields:["name","description"]});return re({selectedCoupon:i,coupons:m,cart:s,onCouponInvalid:()=>d(""),onMinimumAmountWarning:f=>h(f,"warning")}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",t.length,"개 상품"]})]}),p.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',a,'"에 대한 검색 결과가 없습니다.']})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(f=>e.jsx(K,{product:f,remainingStock:r(f),onAddToCart:x},f.id))})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(ee,{cart:s,totals:l,coupons:m,selectedCouponCode:i?.code||null,onUpdateQuantity:o,onRemoveFromCart:c,onSelectCoupon:d,onCompleteOrder:n,getMaxApplicableDiscount:f=>L(f,s)})})]})},k=({label:t,error:s,className:a="",...r})=>e.jsxs("div",{className:"w-full",children:[t&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),e.jsx("input",{className:`w-full px-3 py-2 border rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 ${s?"border-red-500":"border-gray-300"} ${a}`,...r}),s&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:s})]}),oe=t=>t<0?{isValid:!1,error:"가격은 0보다 커야 합니다"}:{isValid:!0},ce=t=>t<0?{isValid:!1,error:"재고는 0보다 커야 합니다"}:t>9999?{isValid:!1,error:"재고는 9999개를 초과할 수 없습니다"}:{isValid:!0},ie=t=>!t||t.trim().length===0?{isValid:!1,error:"쿠폰 코드를 입력해주세요"}:/^[A-Z0-9_-]+$/.test(t)?{isValid:!0}:{isValid:!1,error:"쿠폰 코드는 영문 대문자, 숫자, -, _만 사용 가능합니다"},le=t=>!t||t.trim().length===0?{isValid:!1,error:"쿠폰 이름을 입력해주세요"}:{isValid:!0},I=(t,s)=>t<=0?{isValid:!1,error:"할인값은 0보다 커야 합니다"}:s==="percentage"&&t>100?{isValid:!1,error:"할인율은 100%를 초과할 수 없습니다"}:{isValid:!0};function de({initialProduct:t,onValidationError:s}={}){const[a,r]=u.useState({name:"",price:0,stock:0,description:"",discounts:[],...t});u.useEffect(()=>{r({name:"",price:0,stock:0,description:"",discounts:[],...t})},[t]);const x=u.useCallback((l,d)=>{(d===""||/^\d+$/.test(d))&&r(n=>({...n,[l]:d===""?0:parseInt(d)}))},[]),c=u.useCallback((l,d)=>{const n=parseInt(d)||0;if(l==="price"){const p=oe(n);p.isValid||(s?.(p.error),r(f=>({...f,price:0})))}else if(l==="stock"){const p=ce(n);p.isValid||(s?.(p.error),r(f=>({...f,stock:n>9999?9999:0})))}},[s]),o=u.useCallback((l,d)=>{r(n=>({...n,[l]:d}))},[]),g=u.useCallback(()=>{r(l=>({...l,discounts:[...l.discounts,{quantity:10,rate:.1}]}))},[]),m=u.useCallback(l=>{r(d=>({...d,discounts:d.discounts.filter((n,p)=>p!==l)}))},[]),h=u.useCallback((l,d,n)=>{r(p=>({...p,discounts:p.discounts.map((f,C)=>C===l?{...f,[d]:n}:f)}))},[]),i=u.useCallback(()=>{r({name:"",price:0,stock:0,description:"",discounts:[],...t})},[t]);return{product:a,handleNumberChange:x,handleNumberBlur:c,handleFieldChange:o,addDiscount:g,removeDiscount:m,updateDiscount:h,resetForm:i}}const ue=({initialProduct:t,onSubmit:s,onCancel:a,addNotification:r,isEditing:x})=>{const{product:c,handleNumberChange:o,handleNumberBlur:g,handleFieldChange:m,addDiscount:h,removeDiscount:i,updateDiscount:l}=de({initialProduct:t,onValidationError:n=>r(n,"error")}),d=n=>{n.preventDefault(),s(c)};return e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:x?"상품 수정":"새 상품 추가"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsx(k,{label:"상품명",value:c.name,onChange:n=>m("name",n.target.value),required:!0}),e.jsx(k,{label:"설명",value:c.description,onChange:n=>m("description",n.target.value)}),e.jsx(k,{label:"가격",type:"text",value:c.price===0?"":c.price,onChange:n=>o("price",n.target.value),onBlur:n=>g("price",n.target.value),placeholder:"숫자만 입력",required:!0}),e.jsx(k,{label:"재고",type:"text",value:c.stock===0?"":c.stock,onChange:n=>o("stock",n.target.value),onBlur:n=>g("stock",n.target.value),placeholder:"숫자만 입력",required:!0})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[c.discounts.map((n,p)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"number",value:n.quantity,onChange:f=>l(p,"quantity",parseInt(f.target.value)||0),className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx("input",{type:"number",value:n.rate*100,onChange:f=>l(p,"rate",(parseInt(f.target.value)||0)/100),className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx("button",{type:"button",onClick:()=>i(p),className:"text-red-600 hover:text-red-800",children:e.jsx(D,{className:"w-4 h-4","aria-hidden":!0})})]},p)),e.jsxs("button",{type:"button",onClick:h,className:"text-sm text-indigo-600 hover:text-indigo-800 inline-flex items-center gap-1",children:[e.jsx(M,{className:"w-4 h-4","aria-hidden":!0}),"할인 추가"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(v,{type:"button",onClick:a,variant:"secondary",children:"취소"}),e.jsx(v,{type:"submit",variant:"primary",children:x?"수정":"추가"})]})]})})};function me({onValidationError:t}={}){const[s,a]=u.useState({name:"",code:"",discountType:"amount",discountValue:0}),r=u.useCallback((i,l)=>{a(d=>({...d,[i]:l}))},[]),x=u.useCallback(i=>{a(l=>({...l,code:i.toUpperCase()}))},[]),c=u.useCallback(i=>{a(l=>({...l,discountType:i}))},[]),o=u.useCallback(i=>{(i===""||/^\d+$/.test(i))&&a(l=>({...l,discountValue:i===""?0:parseInt(i)}))},[]),g=u.useCallback(i=>{const l=parseInt(i)||0,d=I(l,s.discountType);d.isValid||(t?.(d.error),s.discountType==="percentage"?a(n=>({...n,discountValue:l>100?100:0})):a(n=>({...n,discountValue:l>1e5?1e5:0})))},[s.discountType,t]),m=u.useCallback(()=>{const i=[],l=le(s.name);l.isValid||i.push(l.error);const d=ie(s.code);d.isValid||i.push(d.error);const n=I(s.discountValue,s.discountType);return n.isValid||i.push(n.error),{isValid:i.length===0,errors:i}},[s]),h=u.useCallback(()=>{a({name:"",code:"",discountType:"amount",discountValue:0})},[]);return{coupon:s,handleFieldChange:r,handleCodeChange:x,handleDiscountTypeChange:c,handleValueChange:o,handleValueBlur:g,validateForm:m,resetForm:h}}const xe=({onSubmit:t,onCancel:s,addNotification:a})=>{const{coupon:r,handleFieldChange:x,handleCodeChange:c,handleDiscountTypeChange:o,handleValueChange:g,handleValueBlur:m,validateForm:h,resetForm:i}=me({onValidationError:d=>a(d,"error")}),l=d=>{d.preventDefault();const n=h();if(!n.isValid){n.errors.forEach(p=>a(p,"error"));return}t(r),i()};return e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(k,{label:"쿠폰명",value:r.name,onChange:d=>x("name",d.target.value),placeholder:"신규 가입 쿠폰",className:"text-sm",required:!0}),e.jsx(k,{label:"쿠폰 코드",value:r.code,onChange:d=>c(d.target.value),placeholder:"WELCOME2024",className:"text-sm font-mono",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs("select",{value:r.discountType,onChange:d=>o(d.target.value),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsx(k,{label:r.discountType==="amount"?"할인 금액":"할인율(%)",type:"text",value:r.discountValue===0?"":r.discountValue,onChange:d=>g(d.target.value),onBlur:d=>m(d.target.value),placeholder:r.discountType==="amount"?"5000":"10",className:"text-sm",required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(v,{type:"button",onClick:s,variant:"secondary",children:"취소"}),e.jsx(v,{type:"submit",variant:"primary",children:"쿠폰 생성"})]})]})})};function he({onAddProduct:t,onUpdateProduct:s,onAddCoupon:a}){const[r,x]=u.useState("products"),[c,o]=u.useState(!1),[g,m]=u.useState(!1),[h,i]=u.useState(null),l=u.useCallback(j=>{i(j),o(!0)},[]),d=u.useCallback(()=>{i(null),o(!0)},[]),n=u.useCallback(j=>{h?s(h.id,j):t(j),i(null),o(!1)},[h,t,s]),p=u.useCallback(()=>{i(null),o(!1)},[]),f=u.useCallback(j=>{a(j),m(!1)},[a]),C=u.useCallback(()=>{m(!1)},[]),S=u.useCallback(()=>{m(j=>!j)},[]);return{activeTab:r,showProductForm:c,showCouponForm:g,editingProduct:h,setActiveTab:x,startEditProduct:l,startAddProduct:d,handleProductSubmit:n,handleProductCancel:p,handleCouponSubmit:f,handleCouponCancel:C,toggleCouponForm:S}}const ge=({addNotification:t,products:s,coupons:a,addProduct:r,updateProduct:x,deleteProduct:c,addCoupon:o,deleteCoupon:g})=>{const{activeTab:m,showProductForm:h,showCouponForm:i,editingProduct:l,setActiveTab:d,startEditProduct:n,startAddProduct:p,handleProductSubmit:f,handleProductCancel:C,handleCouponSubmit:S,handleCouponCancel:j,toggleCouponForm:T}=he({onAddProduct:r,onUpdateProduct:x,onAddCoupon:o});return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>d("products"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${m==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),e.jsx("button",{onClick:()=>d("coupons"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${m==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),m==="products"?e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsxs(v,{onClick:p,variant:"primary",size:"sm",children:[e.jsx(M,{className:"w-4 h-4 mr-2","aria-hidden":!0}),"새 상품 추가"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(b=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:b.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y(b.price)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${b.stock>10?"bg-green-100 text-green-800":b.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[b.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:b.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>n(b),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx("button",{onClick:()=>c(b.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},b.id))})]})}),h&&e.jsx(ue,{initialProduct:l||void 0,onSubmit:f,onCancel:C,addNotification:t,isEditing:!!l})]}):e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[a.map(b=>e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:b.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:b.code}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:b.discountType==="amount"?`${b.discountValue.toLocaleString()}원 할인`:`${P(b.discountValue/100)} 할인`})})]}),e.jsx("button",{onClick:()=>g(b.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:e.jsx(D,{className:"w-5 h-5","aria-hidden":!0})})]})},b.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs(v,{onClick:T,variant:"ghost",className:"flex-col h-auto",children:[e.jsx(M,{className:"w-8 h-8","aria-hidden":!0}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]}),i&&e.jsx(xe,{onSubmit:S,onCancel:j,addNotification:t})]})]})]})},pe=({notifications:t,onRemove:s})=>e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:t.map(a=>e.jsxs("div",{className:`p-4 rounded-md shadow-md text-white flex justify-between items-center ${a.type==="error"?"bg-red-600":a.type==="warning"?"bg-yellow-600":"bg-green-600"}`,children:[e.jsx("span",{className:"mr-2",children:a.message}),e.jsx("button",{onClick:()=>s(a.id),className:"text-white hover:text-gray-200","aria-label":"알림 닫기",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},a.id))}),fe=({isAdmin:t,searchTerm:s,setSearchTerm:a,setIsAdmin:r,cart:x,totalItemCount:c})=>e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!t&&e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx("input",{type:"text",value:s,onChange:o=>a(o.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>r(!t),className:`px-3 py-1.5 text-sm rounded transition-colors ${t?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:t?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!t&&e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"w-6 h-6 text-gray-700","aria-hidden":!0}),x.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:c})]})]})]})})});function F(t,s){const[a,r]=u.useState(()=>{try{const c=localStorage.getItem(t);return c?JSON.parse(c):s}catch(c){return console.error(`Error loading localStorage key "${t}":`,c),s}}),x=u.useCallback(c=>{try{c instanceof Function?r(o=>c(o)):r(c)}catch(o){console.error(`Error setting localStorage key "${t}":`,o)}},[t]);return u.useEffect(()=>{try{a==null||Array.isArray(a)&&a.length===0?localStorage.removeItem(t):localStorage.setItem(t,JSON.stringify(a))}catch(c){console.error(`Error syncing localStorage key "${t}":`,c)}},[t,a]),[a,x]}function be(){const[t,s]=F("cart",[]),a=u.useMemo(()=>t.reduce((m,h)=>m+h.quantity,0),[t]),r=u.useCallback(m=>{const h=t.find(i=>i.product.id===m.id);return m.stock-(h?.quantity||0)},[t]),x=u.useCallback(m=>{if(r(m)<=0)return{success:!1,error:"재고가 부족합니다!"};let i={success:!0,message:"장바구니에 담았습니다"};return s(l=>{const d=l.find(n=>n.product.id===m.id);if(d){const n=d.quantity+1;return n>m.stock?(i={success:!1,error:`재고는 ${m.stock}개까지만 있습니다.`},l):l.map(p=>p.product.id===m.id?{...p,quantity:n}:p)}return[...l,{product:m,quantity:1}]}),i},[r,s]),c=u.useCallback(m=>{s(h=>h.filter(i=>i.product.id!==m))},[s]),o=u.useCallback((m,h,i)=>{if(h<=0)return s(n=>n.filter(p=>p.product.id!==m)),{success:!0};const l=i.find(n=>n.id===m);if(!l)return{success:!1,error:"상품을 찾을 수 없습니다."};const d=l.stock;return h>d?{success:!1,error:`재고는 ${d}개까지만 있습니다.`}:(s(n=>n.map(p=>p.product.id===m?{...p,quantity:h}:p)),{success:!0})},[s]),g=u.useCallback(m=>(s([]),{success:!0,message:`주문이 완료되었습니다. 주문번호: ${m}`}),[s]);return{cart:t,totalItemCount:a,addToCart:x,removeFromCart:c,updateQuantity:o,getRemainingStock:r,completeOrder:g}}function ye(t){const{initialCoupons:s=[]}=t||{},[a,r]=F("coupons",s);u.useEffect(()=>{s.length>0&&a.length===0&&r(s)},[s,a.length,r]);const x=u.useCallback(o=>{let g={success:!0,message:"쿠폰이 추가되었습니다."};return r(m=>m.find(i=>i.code===o.code)?(g={success:!1,error:"이미 존재하는 쿠폰 코드입니다."},m):[...m,o]),g},[r]),c=u.useCallback(o=>(r(g=>g.filter(m=>m.code!==o)),{success:!0,message:"쿠폰이 삭제되었습니다."}),[r]);return{coupons:a,addCoupon:x,deleteCoupon:c}}function je(t){const{initialProducts:s=[]}=t||{},[a,r]=F("products",s);u.useEffect(()=>{s.length>0&&a.length===0&&r(s)},[s,a.length,r]);const x=u.useCallback(i=>(r(l=>[...l,i]),{success:!0,message:"상품이 추가되었습니다."}),[r]),c=u.useCallback((i,l)=>(r(d=>d.map(n=>n.id===i?{...n,...l}:n)),{success:!0,message:"상품이 수정되었습니다."}),[r]),o=u.useCallback(i=>(r(l=>l.filter(d=>d.id!==i)),{success:!0,message:"상품이 삭제되었습니다."}),[r]),g=u.useCallback((i,l)=>(r(d=>d.map(n=>n.id===i?{...n,stock:l}:n)),{success:!0,message:"재고가 수정되었습니다."}),[r]),m=u.useCallback((i,l)=>(r(d=>d.map(n=>n.id===i?{...n,discounts:[...n.discounts,l]}:n)),{success:!0,message:"할인 규칙이 추가되었습니다."}),[r]),h=u.useCallback((i,l)=>(r(d=>d.map(n=>n.id===i?{...n,discounts:n.discounts.filter((p,f)=>f!==l)}:n)),{success:!0,message:"할인 규칙이 삭제되었습니다."}),[r]);return{products:a,addProduct:x,updateProduct:c,deleteProduct:o,updateProductStock:g,addProductDiscount:m,removeProductDiscount:h}}function Ne(t){const{duration:s=3e3}={},[a,r]=u.useState([]),x=u.useCallback((o,g="success",m)=>{const h=m||Date.now().toString();r(i=>[...i,{id:h,message:o,type:g}]),setTimeout(()=>{r(i=>i.filter(l=>l.id!==h))},s)},[s]),c=u.useCallback(o=>{r(g=>g.filter(m=>m.id!==o))},[]);return{notifications:a,addNotification:x,removeNotification:c}}function ve(t,s){const[a,r]=u.useState(t);return u.useEffect(()=>{const x=setTimeout(()=>{r(t)},s);return()=>{clearTimeout(x)}},[t,s]),a}const Ce=()=>`p${Date.now()}`,we=()=>{const t=new Date,s=Z(t).replace(/-/g,""),a=t.getHours().toString().padStart(2,"0")+t.getMinutes().toString().padStart(2,"0");return`ORD-${s}-${a}`},ke=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],Se=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}],Ve=()=>{const[t,s]=u.useState(!1),[a,r]=u.useState(""),x=ve(a,500),{notifications:c,addNotification:o,removeNotification:g}=Ne(),{cart:m,totalItemCount:h,addToCart:i,removeFromCart:l,updateQuantity:d,getRemainingStock:n,completeOrder:p}=be(),{coupons:f,addCoupon:C,deleteCoupon:S}=ye({initialCoupons:Se}),{products:j,addProduct:T,updateProduct:b,deleteProduct:R}=je({initialProducts:ke}),B=N=>{const y=i(N);y.error?o(y.error,"error"):y.message&&o(y.message,"success")},z=(N,y)=>{const w=d(N,y,j);w.error&&o(w.error,"error")},H=()=>{const N=we(),y=p(N);y.message&&o(y.message,"success")},W=N=>{const y=Ce(),w={...N,id:y},A=T(w);A.message&&o(A.message,"success")},_=(N,y)=>{const w=b(N,y);w.message&&o(w.message,"success")},Q=N=>{const y=C(N);y.error?o(y.error,"error"):y.message&&o(y.message,"success")};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.length>0&&e.jsx(pe,{notifications:c,onRemove:g}),e.jsx(fe,{isAdmin:t,searchTerm:a,setSearchTerm:r,setIsAdmin:s,cart:m,totalItemCount:h}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:t?e.jsx(ge,{addNotification:o,products:j,coupons:f,addProduct:W,updateProduct:_,deleteProduct:R,addCoupon:Q,deleteCoupon:S}):e.jsx(ne,{products:j,cart:m,debouncedSearchTerm:x,getRemainingStock:n,addToCart:B,removeFromCart:l,updateQuantity:z,completeOrder:H,coupons:f,addNotification:o})})]})};U.createRoot(document.getElementById("root")).render(e.jsx(J.StrictMode,{children:e.jsx(Ve,{})}));
